<?php
/**
 * Generated by Haxe 4.0.0 (git build development @ 3018ab1)
 */

namespace tink\http\_Header;

use \haxe\ds\StringMap;
use \php\Boot;
use \tink\url\_Query\QueryStringParser;
use \tink\url\_Portion\Portion_Impl_;
use \php\_Boot\HxString;
use \haxe\io\Bytes;
use \haxe\io\_BytesData\Container;
use \php\_Boot\HxAnon;

final class HeaderValue_Impl_ {
	/**
	 * @var \Array_hx
	 */
	static public $DAYS;
	/**
	 * @var \Array_hx
	 */
	static public $MONTHS;


	/**
	 * @param string $username
	 * @param string $password
	 * 
	 * @return string
	 */
	static public function basicAuth ($username, $password) {
		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:187: characters 37-74
		$s = "" . ($username??'null') . ":" . ($password??'null');
		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:187: characters 5-86
		return "Basic " . (base64_encode((new Bytes(strlen($s), new Container($s)))->toString())??'null');
	}


	/**
	 * @param string $this
	 * 
	 * @return StringMap
	 */
	static public function getExtension ($this1) {
		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:157: characters 5-33
		return (HeaderValue_Impl_::parse($this1)->arr[0] ?? null)->extensions;
	}


	/**
	 * @param \Date $d
	 * 
	 * @return string
	 */
	static public function ofDate ($d) {
		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:192: characters 5-103
		return \DateTools::format($d, ((HeaderValue_Impl_::$DAYS->arr[$d->getDay()] ?? null)??'null') . ", %d " . ((HeaderValue_Impl_::$MONTHS->arr[$d->getMonth()] ?? null)??'null') . " %Y %H:%M:%S GMT");
	}


	/**
	 * @param int $i
	 * 
	 * @return string
	 */
	static public function ofInt ($i) {
		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:195: characters 5-25
		return \Std::string($i);
	}


	/**
	 *  Parse the value of this header in to `{value:String, extensions:Map<String, String>}` form
	 * 
	 * @param string $this
	 * 
	 * @return \Array_hx
	 */
	static public function parse ($this1) {
		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:163: lines 163-166
		return HeaderValue_Impl_::parseWith($this1, function ($_, $params) {
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:163: lines 163-166
			$_g = new StringMap();
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:163: characters 59-65
			while ($params->hasNext()) {
				#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:163: lines 163-166
				$p = $params->next();
				#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:163: lines 163-166
				$key = $p->name;
				#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:163: characters 84-102
				$_g1 = Portion_Impl_::toString($p->value);
				#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:164: characters 23-43
				$value = (0 >= strlen($_g1) ? null : ord($_g1[0]));
				#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:163: lines 163-166
				$_g->data[$key] = ($value === 34 ? HxString::substr($_g1, 1, strlen($_g1) - 2) : $_g1);
			}
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:163: lines 163-166
			return $_g;
		});
	}


	/**
	 *  Parse the value of this header, using the given function to parse the extensions
	 *  @param parseExtension - function to parse the extension
	 * 
	 * @param string $this
	 * @param \Closure $parseExtension
	 * 
	 * @return \Array_hx
	 */
	static public function parseWith ($this1, $parseExtension) {
		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:173: lines 173-184
		$_g = new \Array_hx();
		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:173: lines 173-184
		$_g1 = 0;
		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:173: lines 173-184
		$_g2 = \Array_hx::wrap(explode(",", $this1));
		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:173: lines 173-184
		while ($_g1 < $_g2->length) {
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:173: characters 17-18
			$v = ($_g2->arr[$_g1] ?? null);
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:173: lines 173-184
			$_g1 = $_g1 + 1;
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:174: characters 7-19
			$v = trim($v);
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:175: characters 22-36
			$_g3 = HxString::indexOf($v, ";");
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:175: lines 175-178
			$i = ($_g3 === -1 ? strlen($v) : $_g3);
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:179: characters 7-34
			$value = HxString::substr($v, 0, $i);
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:180: lines 180-183
			$x = new HxAnon([
				"value" => $value,
				"extensions" => $parseExtension($value, new QueryStringParser($v, ";", "=", $i + 1)),
			]);
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:180: lines 180-183
			$_g->arr[$_g->length] = $x;
			#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:180: lines 180-183
			++$_g->length;

		}

		#/Users/ut/haxe/haxe_libraries/tink_http/0.8.2/github/403eb075dff5d7b8ec4a9e08052eb01e1e196722/src/tink/http/Header.hx:173: lines 173-184
		return $_g;
	}


	/**
	 * @internal
	 * @access private
	 */
	static public function __hx__init ()
	{
		static $called = false;
		if ($called) return;
		$called = true;


self::$DAYS = \Array_hx::wrap(explode(",", "Sun,Mon,Tue,Wen,Thu,Fri,Sat"));
self::$MONTHS = \Array_hx::wrap(explode(",", "Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec"));
	}
}


Boot::registerClass(HeaderValue_Impl_::class, 'tink.http._Header.HeaderValue_Impl_');
HeaderValue_Impl_::__hx__init();
